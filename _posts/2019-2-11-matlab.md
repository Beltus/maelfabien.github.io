---
published: true
title: Statistics in Matlab
collection: st
layout: single
author_profile: false
read_time: true
categories: [statistics]
excerpt : "Matlab"
header :
    overlay_image: "https://maelfabien.github.io/assets/images/wolf.jpg"
    teaser_image: "https://maelfabien.github.io/assets/images/wolf.jpg"
comments : true
toc: true
toc_sticky: true
---

In this article, we'll cover the main functions to conduct a statistical analysis. I'm working on a sample data set that describes the salaries of employees depending on several features.

<script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

{% highlight matlab %}
{% endhighlight %}

# I. Data exploration

The file I'm working on comes with a small description `DES`. The description of the data is the following.

```matlab
wage      educ      exper     tenure    nonwhite  female    married   numdep   
smsa      northcen  south     west      construc  ndurman   trcommpu  trade    
services  profserv  profocc   clerocc   servocc   lwage     expersq   tenursq  

Obs:   526

1. wage                     average hourly earnings
2. educ                     years of education
3. exper                    years potential experience
4. tenure                   years with current employer
5. nonwhite                 =1 if nonwhite
6. female                   =1 if female
7. married                  =1 if married
8. numdep                   number of dependents
9. smsa                     =1 if live in SMSA
10. northcen                 =1 if live in north central U.S
11. south                    =1 if live in southern region
12. west                     =1 if live in western region
13. construc                 =1 if work in construc. indus.
14. ndurman                  =1 if in nondur. manuf. indus.
15. trcommpu                 =1 if in trans, commun, pub ut
16. trade                    =1 if in wholesale or retail
17. services                 =1 if in services indus.
18. profserv                 =1 if in prof. serv. indus.
19. profocc                  =1 if in profess. occupation
20. clerocc                  =1 if in clerical occupation
21. servocc                  =1 if in service occupation
22. lwage                    log(wage)
23. expersq                  exper^2
24. tenursq                  tenure^2
```

The first step is to load the data set in our path :
```matlab
wage1=load('WAGE1.raw')
[n,k]=size(wage1)
```

Then, we'll plot a histogram of hourly salaries :
```matlab
hist(wage1(:,1))
```

![image](https://maelfabien.github.io/assets/images/wage1.png)

Now, let's plot the histogram for the number of years of education.

![image](https://maelfabien.github.io/assets/images/wage2.png)

We can take a look at the mean of each feature :

```matlab
mean(wage1(:,:))'
```

```
ans =

5.8961
12.5627
17.0171
5.1046
0.1027
...
```

We can also take a look at other descriptive statistics :

```matlab
std(wage1(:,:))'
min(wage1)'
max(wage1)'
cov(wage1)'
corrcoef(wage1(:,:))'
```


# II. Linear regression

## Compute coefficients

We now want to assess the effect of columns 2, 3 and 4 (education, experience, years with current employer) on the salary. 

$$ y_i = \beta_0 + \beta_1 * {x_1}_i + \beta_2 * {x_2}_i  + \beta_3 * {x_3}_i + u_i $$

```matlab
y=wage1(:,1)
X=[ones(n,1),wage1(:,[2,3,4])]
```

We can compute the Beta coefficients and the residuals :

```matlab
beta=inv(X'*X)*X'*y
u=y-X*beta
```

The coefficients are the following :

```matlab
beta =

-2.8727
0.5990
0.0223
0.1693
```

The first coefficient is a constant. Then, the model indicates that an additional year of education should increase the hourly salary by 0.60$. 

## Residuals

We can also plot an histogram of the residuals. The distribution of the residual appears to be close to a normal one.

![image](https://maelfabien.github.io/assets/images/histu.png)

We can decide to remove outliers above 5 for example :

```matlab
indices = find(u>2.5);
u(indices) = [];
hist(u)
```

## Test hypothesis

Are the coefficients significant ?

In order to assess the significance of each estimator, we need to estimate their standard deviation.

```matlab
sig2=u'*u/(n-4)
std=sqrt(diag(sig2*inv(X'*X)))
```

Then, we can easily compute the test statistic :

```matlab
t = beta./std
```

```
t =

-5.6300
16.6857
2.6471
11.1725
```

What should we compare the test statistics to ? Well, to the critical value ! For example, since we estimate 4 parameters, the 95% critical value is :

```
C1 = tinv(0.95, n-4)
```

```
C1 =

1.6478
```

The T-stats are all greater than the critical value. For this reason, we reject the hypothesis $$ H_0 $$ that the variables have no impact on the output.

## Test hypothesis


> **Conclusion** : This was a quick introduction to Matlab. I hope you found it useful. Don't hesitate to drop a comment if you have a question.
